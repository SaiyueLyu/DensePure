starting the model and loader...
diffusion_type: guided-ddpm
model_config: {'image_size': 256, 'num_channels': 256, 'num_res_blocks': 2, 'num_heads': 4, 'num_heads_upsample': -1, 'num_head_channels': 64, 'attention_resolutions': '32,16,8', 'channel_mult': '', 'dropout': 0.0, 'class_cond': False, 'use_checkpoint': False, 'use_scale_shift_norm': True, 'resblock_updown': True, 'use_fp16': True, 'use_new_attention_order': False, 'learn_sigma': True, 'diffusion_steps': 1000, 'noise_schedule': 'linear', 'timestep_respacing': '1000', 'use_kl': False, 'predict_xstart': False, 'rescale_timesteps': True, 'rescale_learned_sigmas': False}
/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
apply the attack to diffpure + classifier [L2]...
diffusion times: 0
img is -10.728190422058105, 10.858771324157715
Traceback (most recent call last):
  File "eval_certified_densepure.py", line 504, in <module>
    robustness_eval(args, config)
  File "eval_certified_densepure.py", line 407, in robustness_eval
    purified_certify(model, dataset, args, config)
  File "eval_certified_densepure.py", line 347, in purified_certify
    prediction, radius, n0_predictions, n_predictions = smoothed_classifier_diffpure.certify(x, args.N0, args.N, i, args.alpha, args.certified_batch, args.clustering_method)
  File "/data1/saiyuel/projects/DensePure/core.py", line 39, in certify
    counts_selection, n0_predictions = self._sample_noise(x, n0, batch_size, clustering_method, sample_id)
  File "/data1/saiyuel/projects/DensePure/core.py", line 137, in _sample_noise
    predictions = self.base_classifier(batch + noise, sample_id).argmax(1)
  File "/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "eval_certified_densepure.py", line 87, in forward
    x_re = self.runner.image_editing_sample((x - 0.5) * 2, bs_id=counter, tag=self.tag, sigma=self.args.sigma)
  File "/data1/saiyuel/projects/DensePure/runners/diffpure_guided_densepure.py", line 128, in image_editing_sample
    out = self.diffusion.p_sample(
  File "/data1/saiyuel/projects/DensePure/guided_diffusion/gaussian_diffusion.py", line 432, in p_sample
    out = self.p_mean_variance(
  File "/data1/saiyuel/projects/DensePure/guided_diffusion/respace.py", line 91, in p_mean_variance
    return super().p_mean_variance(self._wrap_model(model), *args, **kwargs)
  File "/data1/saiyuel/projects/DensePure/guided_diffusion/gaussian_diffusion.py", line 255, in p_mean_variance
    model_output = model(x, self._scale_timesteps(real_t), **model_kwargs)
  File "/data1/saiyuel/projects/DensePure/guided_diffusion/respace.py", line 128, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data1/saiyuel/projects/DensePure/guided_diffusion/unet.py", line 656, in forward
    h = module(h, emb)
  File "/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data1/saiyuel/projects/DensePure/guided_diffusion/unet.py", line 75, in forward
    x = layer(x, emb)
  File "/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data1/saiyuel/projects/DensePure/guided_diffusion/unet.py", line 232, in forward
    return checkpoint(
  File "/data1/saiyuel/projects/DensePure/guided_diffusion/nn.py", line 135, in checkpoint
    return func(*inputs)
  File "/data1/saiyuel/projects/DensePure/guided_diffusion/unet.py", line 244, in _forward
    h = self.in_layers(x)
  File "/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 457, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/saiyuel/anaconda3/envs/denp/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 453, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
KeyboardInterrupt
